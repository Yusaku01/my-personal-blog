---
import { getCollection } from 'astro:content';
import Layout from '../layouts/Layout.astro';
import HeroSection from '../components/Hero/HeroSection.astro';
import { PostCard } from '../components/Blog/PostCard';
import SectionHeading from '../components/Section/SectionHeading.astro';
import { getQiitaPosts } from '../lib/api-clients/qiita';

const posts = await getCollection('blog');
const qiitaPosts = await getQiitaPosts('ngtnysk');

const allPosts = [
  ...posts.map((post) => ({
    title: post.data.title,
    url: `/blog/${post.slug}`,
    publishDate: post.data.publishDate,
    excerpt: post.data.description,
    thumbnail: post.data.image,
    isExternal: false,
    tags: post.data.tags || [],
    platform: '',
  })),
  ...qiitaPosts,
].sort((a, b) => b.publishDate.getTime() - a.publishDate.getTime());

const POSTS_PER_SECTION = 4;

import { Image } from 'astro:assets';
import myImage from '../assets/img/img_profile.png';
---

<Layout title="SAKUSPACE">
  <HeroSection title="SAKUSPACE" isHome={true} />
  <div class="py-16">
    <div class="container-lg container-base">
      <section class="mb-16">
        <SectionHeading title="BLOG" className="heading-h2 tracking-widest" />
        <div class="blog-post-grid">
          {
            allPosts
              .slice(0, POSTS_PER_SECTION)
              .map((post) => (
                <PostCard
                  client:load
                  title={post.title}
                  url={post.url}
                  publishDate={post.publishDate}
                  excerpt={post.excerpt}
                  platform={post.platform}
                  isExternal={post.isExternal}
                  thumbnail={post.thumbnail}
                  tags={post.tags || []}
                  showTags={false}
                />
              ))
          }
        </div>
        <div class="text-center mt-8">
          <a href="/blog" class="btn-primary inline-block">すべての記事を見る</a>
        </div>
      </section>

      <section class="mb-16">
        <SectionHeading title="PROFILE" className="heading-h2 tracking-widest" />
        <div class="py-6">
          <div class="flex flex-col md:flex-row gap-4 md:gap-8 items-center">
            <div class="w-32 h-32 rounded-full overflow-hidden flex-shrink-0">
              <Image
                src={myImage}
                alt="プロフィール画像"
                class="w-full h-full object-cover"
                width="128"
                height="128"
              />
            </div>
            <div class="flex-grow">
              <h3 class="heading-h3 text-center md:text-left mb-2">長谷 優作</h3>
              <p class="text-gray-700 dark:text-gray-300 mb-6 mb:mb-4 text-center md:text-left">
                フロントエンドエンジニア / デザイナー
              </p>
              <p class="text-gray-600 dark:text-gray-400">
                フロントエンドエンジニアとしての経験とデザインの知識を活かし、Web制作をしています。<br
                />最近はLLMを使った作業効率化に興味があります。Windsurfが好きです。
              </p>
            </div>
          </div>
          <div class="mt-6 text-center">
            <a href="/profile" class="btn-primary inline-block">詳しく見る</a>
          </div>
        </div>
      </section>
    </div>
  </div>
</Layout>
